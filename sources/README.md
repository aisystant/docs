# Конвертация Word → Markdown

Инструкция по конвертации Word-документов (.docx) в структурированные Markdown-файлы.

## Структура папки

```
sources/
├── word-files/                          ← сюда кладём .docx файлы
├── 1-3-systems-thinking-introduction/   ← пример результата конвертации
├── format-guide.md                      ← правила форматирования (справочник)
└── README.md                            ← эта инструкция
```

Каждый сконвертированный курс хранится в отдельной папке внутри `sources/` с именем курса (например, `1-3-systems-thinking-introduction`).

## Пошаговая инструкция

### Шаг 1. Положить Word-файл

Скопируйте `.docx` файл в папку `sources/word-files/`:

```
sources/word-files/мой-курс.docx
```

Требования к файлу:
- Заголовки в Word оформлены стилями (Заголовок 1, Заголовок 2 и т.д.)
- Заголовок 1 = разделы курса (будут папками)
- Заголовок 2 = подразделы (будут отдельными .md файлами)
- Изображения вставлены в документ (будут извлечены автоматически)

### Шаг 2. Установить зависимости (только первый раз)

```bash
# pandoc — конвертер документов
brew install pandoc

# Python-пакет для транслитерации
pip3 install -r scripts/convert_word/requirements.txt
```

### Шаг 3. Запустить конвертацию

Из корня репозитория `docs/`:

```bash
./scripts/convert_word/run.sh "sources/word-files/мой-курс.docx" sources/имя-курса
```

Где `имя-курса` — slug курса в kebab-case (например, `1-3-systems-thinking-introduction`).

Можно указать название курса:

```bash
./scripts/convert_word/run.sh "sources/word-files/мой-курс.docx" sources/1-3-systems-thinking-introduction \
  --course-title "Введение в системное мышление"
```

Скрипт автоматически:
1. Конвертирует .docx → Markdown через pandoc
2. Разобьёт на разделы и подразделы по заголовкам
3. Извлечёт и переименует изображения (формат `fig-01`, `fig-02`...)
4. Сгенерирует YAML front matter для каждого файла
5. Запустит валидацию по правилам format-guide.md

### Шаг 4. Проверить результат

Результат конвертации появится в `sources/имя-курса/`:

```
sources/имя-курса/
├── index.md                    ← главная страница курса
├── 00-intro/
│   ├── index.md
│   ├── 01-predislovie.md
│   └── 02-zadanie.md
├── 01-название-раздела/
│   ├── index.md
│   ├── 01-подраздел.md
│   ├── 02-подраздел.md
│   └── assets/
│       ├── fig-01.png
│       └── fig-02.png
└── ...
```

Что проверить:
- Откройте несколько .md файлов — текст, форматирование, заголовки
- Проверьте, что изображения на месте (папки `assets/`)
- Обратите внимание на предупреждения валидатора в консоли

Можно запустить валидацию отдельно:

```bash
python3 scripts/convert_word/validate.py sources/имя-курса/
```

### Шаг 5. Перенести в docs/ru/

После проверки переместите результат в нужную категорию:

```bash
# Для курсов категории "personal"
mv sources/имя-курса docs/ru/personal/имя-курса

# Для курсов категории "professional"
mv sources/имя-курса docs/ru/professional/имя-курса
```

## Повторная конвертация

Если нужно переконвертировать файл (например, обновлённая версия курса):

```bash
# Скрипт автоматически удалит старый результат и создаст заново
./scripts/convert_word/run.sh "sources/word-files/новая-версия.docx" sources/имя-курса
```

## Справочные файлы

- **format-guide.md** — все правила форматирования (заголовки, изображения, front matter, типы подразделов)
- **scripts/convert_word/convert.py** — скрипт конвертации
- **scripts/convert_word/validate.py** — валидатор
